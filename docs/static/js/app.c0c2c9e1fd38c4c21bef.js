webpackJsonp([1],{KKXB:function(t,e){},MSK5:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),s=n("kxiW"),o=n.n(s),a=n("1mcD"),r=n.n(a),c=n("yviF"),l=n.n(c);n("881v");i.a.use(r.a),l.a.initializeApp({databaseURL:"https://waffly-a74d7.firebaseio.com",projectId:"waffly-a74d7"});l.a.firestore().settings({timestampsInSnapshots:!0});var h=l.a.firestore(),u={name:"App",computed:{randomId:function(){for(var t=0;t<8;t++){var e=parseInt(3*Math.random());this.linkId+=0==e?String.fromCharCode(26*Math.random()+65):1==e?String.fromCharCode(26*Math.random()+97):parseInt(10*Math.random())}return this.linkId}},data:function(){return{linkId:"",dataLoaded:!1,db:{}}},firestore:function(){},mounted:function(){var t=o.a.firestore();t.settings({timestampsInSnapshots:!0}),this.db=t}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("table",[e("h1",[this._v("Waffly")]),this._v(" "),e("router-view",{ref:"clientRef",attrs:{db:this.db}})],1)])},staticRenderFns:[]};var m=n("VU/8")(u,d,!1,function(t){n("fGQI")},null,null).exports,g=n("/ocq"),p=n("fZjL"),f=n.n(p),v=n("bOdI"),_=n.n(v),b={name:"Pie",props:["centerX","centerY","radius","segNum","index","angle","color"],data:function(){return{pieColor:void 0!==this.color?this.color:"magenta"}},computed:{arc:function(){return 2*Math.PI/this.segNum}},mounted:function(){},methods:{segment:function(t,e,n,i,s){var o={x:t+n*Math.cos(i),y:e+n*Math.sin(i)},a={x:t+n*Math.cos(s),y:e+n*Math.sin(s)};return["M",o.x,o.y,"A",n,n,0,0,1,a.x,a.y,"L",t,e,"L",o.x,o.y].join(" ")},changeSelection:function(t){this.$emit("changeSelection",t)}}},I={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("path",{staticClass:"pie",attrs:{d:t.segment(t.centerX,t.centerY,t.radius,t.angle+t.index*t.arc,t.angle+t.index*t.arc+t.arc),fill:t.pieColor,stroke:"white"},on:{click:function(e){t.changeSelection(t.index)}}})},staticRenderFns:[]};var x=n("VU/8")(b,I,!1,function(t){n("MSK5")},"data-v-0db0e2b1",null).exports,w=2*Math.PI,L=180/Math.PI,O={name:"Waffly",components:{Pie:x},props:["segNum","segments","stopTime","colorList"],data:function(){return{msg:"Waffly",centerX:250,centerY:250,radius:180,angle:0,time:0,timeout:0,finalVal:0,speed:Math.PI/120,run:!1}},mounted:function(){this.draw();for(var t=0;t<this.segNum;t++)this.segments[t].id=t},methods:{setTimer:function(){var t=this;this.run||(this.timeout=setInterval(function(){return t.draw()},1),this.run=!0)},draw:function(){this.time+=10,this.angle+=this.speed;for(var t=0;t<this.segNum;t++){var e=L*(t*(w/this.segNum)+w/(2*this.segNum)+this.angle);this.segments[t].rotation="rotate("+e+", "+this.centerX+", "+this.centerY+")"}var n=Math.floor((2*Math.PI-this.angle%(2*Math.PI))/(2*Math.PI/this.segNum));this.finalVal=n,this.time>=this.stopTime&&(clearTimeout(this.timeout),this.run=!1,this.time=0),this.$emit("result",this.finalVal)},changeSelection:function(t){this.$emit("changeSelection",t)}}},S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wheel"},[n("svg",{attrs:{height:"520",width:"520"}},[n("circle",{attrs:{cx:this.centerX,cy:this.centerY,r:this.radius+35,fill:"purple"}}),t._v(" "),t._l(t.segNum,function(e){return n("Pie",{key:e-1,attrs:{centerX:t.centerX,centerY:t.centerY,radius:t.radius,segNum:t.segNum,index:e-1,angle:t.angle,color:t.colorList[(e-1)%t.colorList.length],segments:t.segments},on:{changeSelection:t.changeSelection}})}),t._v(" "),t._l(t.segNum,function(e){return n("text",{attrs:{x:Math.cos(8*Math.PI/4)*(t.radius-30)+t.centerX,y:Math.sin(8*Math.PI/4)*(t.radius-30)+t.centerY,"font-size":"20",fill:"#343938","text-anchor":"middle","alignment-baseline":"middle",transform:t.segments[e-1].rotation}},[t._v(t._s(e))])}),t._v(" "),n("rect",{attrs:{x:this.centerX+this.radius-15,y:this.centerY-2.5,fill:"black",width:"50",height:"5","alignment-baseline":"middle"}}),t._v(" "),n("circle",{attrs:{cx:this.centerX,cy:this.centerY,r:"50",fill:"purple"}}),t._v(" "),t.finalVal in t.segments?n("text",{attrs:{x:t.centerX,y:t.centerY+t.radius+70,"font-size":"32","text-anchor":"middle","alignment-baseline":"middle"}},[t._v(t._s(t.segments[t.finalVal].name))]):t._e()],2)])},staticRenderFns:[]},N=n("VU/8")(O,S,!1,null,null,null).exports,C={name:"OptionList",components:{},props:["segments","segNum","spinResult"],data:function(){return{edit:-1,editVal:""}},mounted:function(){},methods:{highlight:function(t){return this.spinResult==t},changeText:function(t){this.edit=t,this.setFocus(t)},newOptionVal:function(t){this.edit=-1,this.$emit("changeOption",t,this.segments[t].name),this.editVal=""},removeTextInput:function(){this.edit=-1},addOption:function(){var t=this.segNum;this.edit=t,this.setFocus(t)},removeOption:function(t){this.$emit("removeOption",t)},setFocus:function(t){var e=this;this.$nextTick(function(){this.edit=t}),setTimeout(function(){e.$refs.textBox[t].focus(),e.$refs.textBox[t].select()},0)}}},M={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"option-list"},[n("table",t._l(t.segNum,function(e){return n("tr",{class:{highlighted:t.highlight(e-1)}},[n("td",[n("button",{on:{click:function(n){t.removeOption(e-1)}}},[t._v("-")])]),t._v(" "),n("td",[t._v(t._s(e)+".")]),t._v(" "),n("td",{on:{click:function(n){t.changeText(e-1)}}},[-1==t.edit||-1!=t.edit&&t.edit!=e-1?n("div",[t._v("\n        "+t._s(t.segments[e-1].name)+"\n        ")]):t._e(),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.segments[e-1].name,expression:"segments[i - 1]['name']"}],ref:"textBox",refInFor:!0,class:{highlighted:t.highlight(e-1)},attrs:{type:"text",hidden:!(-1!=t.edit&&t.edit==e-1)},domProps:{value:t.segments[e-1].name},on:{keyup:function(n){if(!("button"in n)&&t._k(n.keyCode,"enter",13,n.key,"Enter"))return null;t.newOptionVal(e-1)},input:function(n){n.target.composing||t.$set(t.segments[e-1],"name",n.target.value)}}})])])}))])},staticRenderFns:[]};var $=n("VU/8")(C,M,!1,function(t){n("nR+3")},"data-v-d22af828",null).exports,k={name:"SpinPage",components:{Wheel:N,OptionList:$},props:["db"],computed:{newPage:function(){for(var t="",e=0;e<8;e++){var n=parseInt(3*Math.random());t+=0==n?String.fromCharCode(26*Math.random()+65):1==n?String.fromCharCode(26*Math.random()+97):parseInt(10*Math.random())}return t}},firestore:function(){},data:function(){return{loadedData:[],pageId:0,dataLoaded:!1,segNum:10,segments:{0:{rotation:"",color:"lavenderblush",id:"",name:""},1:{rotation:"",color:"lightcoral",id:"",name:""},2:{rotation:"",color:"lightgreen",id:"",name:""},3:{rotation:"",color:"lightseagreen",id:"",name:""},4:{rotation:"",color:"lightsteelblue",id:"",name:""},5:{rotation:"",color:"lavenderblush",id:"",name:""},6:{rotation:"",color:"lightcoral",id:"",name:""},7:{rotation:"",color:"lightgreen",id:"",name:""},8:{rotation:"",color:"lightseagreen",id:"",name:""},9:{rotation:"",color:"lightsteelblue",id:"",name:""}},result:9,colorList:["lavenderblush","lightcoral","lightgreen","lightseagreen","lightsteelblue"],dessertList:["Ice Cream","Cake","Brownie","Pie","Cookie","Fruit","Chocolate","Cupcake"],buttonInfo:"Decide on Dessert",buttonListId:0}},created:function(){this.pageId=this.newPage},beforeRouteLeave:function(t,e,n){n()},mounted:function(){this.init(),this.dataLoaded=!0},methods:{init:function(){this.segments[0].name="Italian",this.segments[1].name="Chinese",this.segments[2].name="Mexican",this.segments[3].name="American",this.segments[4].name="Korean",this.segments[5].name="Indian",this.segments[6].name="Mediterranean",this.segments[7].name="Japanese",this.segments[8].name="French",this.segments[9].name="Seafood"},spin:function(){this.$refs.wheel.setTimer()},spinResult:function(t){this.result=t},changeSelection:function(t){this.$refs.option.changeText(t)},changeOptionText:function(t,e){this.segments[t].name=e;var n=this.db.collection("shared_page").doc(this.pageId);n.get().then(function(i){if(i.exists){i.data();n.update(_()({},"options."+t,e))}})},removeInput:function(t){this.$refs.option.removeTextInput()},addOption:function(){this.segments[this.segNum]={rotation:"",color:this.colorList[this.segNum%this.colorList.length],optionId:this.segNum++,name:""},this.$refs.option.addOption(),this.updateWheel()},removeOption:function(t){for(var e=t;e<this.segNum-1;e++)this.segments[e]=this.segments[e+1];""!=this.pageId&&this.db.collection("shared_page").doc(this.pageId).update(_()({},"options."+t,o.a.firestore.FieldValue.delete()));this.segNum--,this.$nextTick(function(){this.$refs.wheel.draw()})},changeList:function(){if(0==this.buttonListId){for(var t=0;t<this.dessertList.length;t++)this.segments[t].name=this.dessertList[t];this.segNum=this.dessertList.length,this.buttonInfo="Decide on Meal",this.buttonListId=1}else this.init(),this.segNum=f()(this.segments).length,this.buttonInfo="Decide on Dessert",this.buttonListId=0;this.updateWheel()},updateWheel:function(){this.$nextTick(function(){this.$refs.wheel.draw()})},createPage:function(){var t=((new Date).getHours()+1)%25,e=this.db.collection("shared_page_list").doc("temp_page"),n=this.newPage;e.get().then(function(i){if(i.exists){var s=i.data();t in s?e.update(_()({},t,o.a.firestore.FieldValue.arrayUnion(n))):e.update(_()({},t,[n]))}});this.db.collection("shared_page").doc(this.newPage).set({options:{0:"Italian",1:"Chinese",2:"Mexican",3:"American",4:"Korean",5:"Indian",6:"Mediterranean",7:"Japanese",8:"French",9:"Seafood"},nextId:10})}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"defaultpage"}},[n("router-view"),t._v(" "),n("table",{staticStyle:{margin:"auto"}},[n("tr",[n("td",{staticClass:"list",staticStyle:{"padding-top":"80px"},on:{click:t.removeInput}},[n("button",{staticClass:"button button-spin",on:{click:t.spin}},[t._v("Spin!")]),t._v(" "),n("button",{staticClass:"button button-list",on:{click:t.changeList}},[t._v(t._s(t.buttonInfo))]),t._v(" "),n("button",{staticClass:"button button-add",on:{click:t.addOption}},[t._v("Add Option")]),t._v(" "),n("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:"custom/"+t.pageId}},["WafflyDefault"==this.$route.name?n("button",{staticClass:"button button-create",on:{click:t.createPage}},[t._v("Create a New Page to Share")]):t._e()])],1),t._v(" "),n("td",{staticClass:"list"},[n("Wheel",{ref:"wheel",attrs:{segNum:t.segNum,segments:t.segments,stopTime:7e3*Math.random()+3e3,colorList:t.colorList},on:{result:t.spinResult,changeSelection:t.changeSelection}})],1),t._v(" "),n("td",[n("OptionList",{ref:"option",staticClass:"option-list",attrs:{segments:t.segments,segNum:t.segNum,spinResult:t.result,id:"optionList"},on:{changeOption:t.changeOptionText,removeOption:t.removeOption}})],1)])])],1)},staticRenderFns:[]};var P=n("VU/8")(k,y,!1,function(t){n("sSoH")},null,null).exports,T={name:"SpinPage",components:{Wheel:N,OptionList:$},props:["db"],computed:{segNum:function(){return this.segments.length}},data:function(){return{pageId:this.newPage,dataLoaded:!1,segments:[],colorList:["lavenderblush","lightcoral","lightgreen","lightseagreen","lightsteelblue"],result:9,buttonListId:0,url:window.location.href}},watch:{},created:function(){this.pageId=this.$route.params.id;var t=h.collection("shared_page").doc(this.pageId),e=this.segments;this.colorList;t.get().then(function(t){if(t.exists){var n=t.data();for(var i in n.options)e.push({name:n.options[i],rotation:"",optionId:parseInt(i)})}}),this.dataLoaded=!0},methods:{spin:function(){this.$refs.wheel.setTimer()},spinResult:function(t){this.result=t},changeSelection:function(t){this.$refs.option.changeText(t)},changeOptionText:function(t,e){this.segments[t].name=e;var n=this.segments[t].optionId,i=this.db.collection("shared_page").doc(this.pageId);i.get().then(function(t){if(t.exists){t.data();i.update(_()({},"options."+n,e))}})},removeInput:function(t){this.$refs.option.removeTextInput()},addOption:function(){var t=this.db.collection("shared_page").doc(this.pageId),e=0,n=this.segments,i=this;t.get().then(function(s){if(s.exists){var o,a=s.data();e=a.nextId,t.update((o={},_()(o,"nextId",e+1),_()(o,"options."+e,""),o)),n.push({rotation:"",optionId:e,name:""}),i.$refs.option.addOption(),i.updateWheel()}})},removeOption:function(t){var e=this.segments;""!=this.pageId&&this.db.collection("shared_page").doc(this.pageId).update(_()({},"options."+e[t].optionId,o.a.firestore.FieldValue.delete()));this.segments.splice(t,1),this.$nextTick(function(){this.$refs.wheel.draw()})},updateWheel:function(){this.$nextTick(function(){this.$refs.wheel.draw()})}}},R={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"spinpage"}},[n("table",{staticStyle:{margin:"auto"}},[n("tr",[n("td",{staticClass:"list",staticStyle:{"padding-top":"160px"},on:{click:t.removeInput}},[n("button",{staticClass:"button button-spin",on:{click:t.spin}},[t._v("Spin!")]),t._v(" "),n("button",{staticClass:"button button-add",on:{click:t.addOption}},[t._v("Add Option")])]),t._v(" "),n("td",{staticClass:"list"},[t.segments.length>0?n("Wheel",{ref:"wheel",attrs:{segNum:t.segNum,segments:t.segments,stopTime:7e3*Math.random()+3e3,colorList:t.colorList},on:{result:t.spinResult,changeSelection:t.changeSelection}}):t._e()],1),t._v(" "),n("td",[t.segments.length>0?n("OptionList",{ref:"option",staticClass:"option-list",attrs:{segments:t.segments,segNum:t.segNum,spinResult:t.result,id:"optionList"},on:{changeOption:t.changeOptionText,removeOption:t.removeOption}}):t._e()],1)])]),t._v(" "),n("div",{staticClass:"info-box"},[t._v("Share this URL with other people to edit the options. This link will be active for at least 24 hours. "+t._s(t.url))])])},staticRenderFns:[]};var V=n("VU/8")(T,R,!1,function(t){n("KKXB")},"data-v-3289caf6",null).exports,F={name:"AboutPage",components:{OptionList:$},props:["newPage","db"],beforeRouteLeave:function(t,e,n){console.log("after"),n()}},W={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"aboutpage"}},[this._v("\n  "+this._s(this.newPage)+"\n")])},staticRenderFns:[]};var X=n("VU/8")(F,W,!1,function(t){n("c38O")},null,null).exports;i.a.use(g.a);var A=new g.a({routes:[{path:"/",name:"WafflyDefault",component:P},{path:"/custom/:id",name:"WafflySpin",component:V},{path:"/about",name:"About",component:X}]});i.a.config.productionTip=!1,new i.a({el:"#app",router:A,components:{App:m},template:"<App/>"})},c38O:function(t,e){},fGQI:function(t,e){},"nR+3":function(t,e){},sSoH:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.c0c2c9e1fd38c4c21bef.js.map